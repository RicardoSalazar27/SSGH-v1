{"version":3,"sources":["Infohotel.js","auth.js","registro.js","usuarios.js"],"names":["window","location","pathname","btnActualizarInfo","document","getElementById","mostrarAlerta","titulo","mensaje","tipo","Swal","fire","icon","title","text","then","$","modal","reload","addEventListener","async","e","preventDefault","hotel","id","dataset","nombre","value","trim","telefono","correo","ubicacion","img","files","datos","FormData","Object","entries","forEach","key","append","url","respuesta","fetch","method","body","resultado","json","error","console","log","btniniciarSesion","mostrarAlerta2","mensajeResultado","style","display","textContent","className","setTimeout","event","usuario","email","password","autorizado","href","btnCrear","nuevoUsuario","apellidos","password2","direccion","dataTable","dataTableInit","rolesDictionary","1","2","3","estatusDictionary","0","dataTableOption","destroy","pageLength","language","dom","columnDefs","orderable","targets","visible","initDataTable","usuarios","listarUsers","length","llenarTabla","DataTable","response","tbody","innerHTML","user","index","rol","rol_id","estatus","row","apellido","target","closest","botonSubirUsuario","querySelector","classList","replace","cargarDatosUsuario","getAttribute","contains","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","result","isConfirmed","confirmarEliminacion","ok","src","llenarModal","btnActualizarUsuario","nuevoBtn","cloneNode","replaceWith","usuarioactualizado","test","cambios","File","keys"],"mappings":"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","file":"bundle.js","sourcesContent":["if (window.location.pathname === '/admin/configuracion/informacion') {\n    //Obtener datos del formulario por si hay actualizacion\n    const btnActualizarInfo = document.getElementById('btnActualizarInfo');\n\n    if(btnActualizarInfo){\n        btnActualizarInfo.addEventListener('click', async function(e){\n            e.preventDefault();\n            //alert('diste click en actualizar info');\n\n            const hotel = {\n                id: btnActualizarInfo.dataset.id, \n                nombre : document.getElementById('nombre').value.trim(),\n                telefono : document.getElementById('telefono').value.trim(),\n                correo : document.getElementById('correo').value.trim(),\n                ubicacion : document.getElementById('ubicacion').value.trim(),\n                img : document.getElementById('logo').files[0]\n            }\n\n            try {\n                //Crear datos para enviar en formdata\n                const datos  = new FormData();\n                Object.entries(hotel).forEach(([key, value]) => datos.append(key, value));\n                const url = 'http://localhost:3000/admin/configuracion/informacion/actualizar';\n                const respuesta = await fetch(url, { // Corregido: Usar un objeto en lugar de un array\n                    method: 'POST',\n                    body: datos\n                });\n\n                const resultado = await respuesta.json();\n                mostrarAlerta(resultado.titulo, resultado.mensaje, resultado.tipo);\n                                \n            } catch (error) {\n                console.log('error');\n            }\n\n        })\n    }\n\n    function mostrarAlerta(titulo, mensaje, tipo) {\n        Swal.fire({\n            icon: tipo,\n            title: titulo,\n            text: mensaje,\n        }).then(() => {\n            $('.modal').modal('hide');\n            location.reload(); // Recarga la página automáticamente\n        });\n    }        \n}","if (window.location.pathname === '/login') {\n    const btniniciarSesion = document.getElementById('btnIniciarSesion');\n\n    if( btniniciarSesion){\n        btniniciarSesion.addEventListener('click', async function (event) {\n            event.preventDefault();\n\n            const usuario = {\n                email: document.getElementById('email').value.trim(),\n                password: document.getElementById('password').value.trim()\n            };\n\n            if( usuario.email === \"\" || usuario.password === \"\"){\n                mostrarAlerta2('Todos los campos son obligatorios', 'error');\n                return;\n            }\n\n            try {\n                // Crear FormData para enviar los datos\n                const datos = new FormData();\n                Object.entries(usuario).forEach(([key, value]) => datos.append(key, value));\n                const url = 'http://localhost:3000/login';\n                const respuesta = await fetch(url, { // Corregido: Usar un objeto en lugar de un array\n                    method: 'POST',\n                    body: datos\n                });\n\n                // Esperar la respuesta en formato JSON\n                const resultado = await respuesta.json();\n                if(resultado.autorizado){\n                    window.location.href = '/admin/index';\n                } else{\n                    mostrarAlerta2(resultado.mensaje, resultado.tipo);\n                }\n\n            } catch (error) {\n                console.log(error);\n            }\n        })\n    }\n\n    function mostrarAlerta2(mensaje, tipo) {\n        const mensajeResultado = document.getElementById('mensaje-resultado');\n        mensajeResultado.style.display = 'block'; // Asegúrate de que el contenedor se muestre\n        mensajeResultado.textContent = mensaje; // Mostrar solo el mensaje\n    \n        // Cambiar el color de fondo del contenedor según el tipo de mensaje\n        if (tipo === 'error') {\n            mensajeResultado.className = 'alert alert-danger'; // Rojo para error\n        } else if (tipo === 'success') {\n            mensajeResultado.className = 'alert alert-success'; // Verde para éxito\n        } else {\n            mensajeResultado.className = 'alert alert-info'; // Azul o información por defecto\n        }\n    \n        // Opcional: Ocultar el mensaje después de 5 segundos\n        setTimeout(() => {\n            mensajeResultado.style.display = 'none';\n        }, 5000);\n    }\n}","if (window.location.pathname === '/registro') {\n\n    const btnCrear = document.getElementById('crear-cuenta');\n\n    if (btnCrear) {\n        btnCrear.addEventListener('click', async function(event) { // Marca la función como 'async'\n\n            event.preventDefault();\n\n            const nuevoUsuario = {\n                nombre: document.getElementById('nombre').value.trim(),\n                apellidos: document.getElementById('apellidos').value.trim(),\n                email: document.getElementById('email').value.trim(),\n                password: document.getElementById('password').value.trim(),\n                password2: document.getElementById('password2').value.trim(),\n                telefono: document.getElementById('telefono').value.trim(),\n                direccion: document.getElementById('direccion').value.trim()\n            };\n\n            if (nuevoUsuario.email === \"\" || nuevoUsuario.nombre === \"\" || nuevoUsuario.direccion === \"\" || nuevoUsuario.password === \"\" || nuevoUsuario.password2 === \"\" || nuevoUsuario.telefono === \"\") {\n                mostrarAlerta2('Todos los campos son necesarios', 'error');\n                return;\n            }\n            \n            if (nuevoUsuario.password !== nuevoUsuario.password2) {\n                mostrarAlerta2('Las contraseñas no coinciden', 'error');\n                return;\n            }\n            \n            // Eliminar 'password2' antes de enviarlo al servidor\n            delete nuevoUsuario.password2;\n\n            try {\n                // Crear FormData para enviar los datos\n                const datos = new FormData();\n                Object.entries(nuevoUsuario).forEach(([key, value]) => datos.append(key, value));\n                const url = 'http://localhost:3000/registro';\n                const respuesta = await fetch(url, { // Corregido: Usar un objeto en lugar de un array\n                    method: 'POST',\n                    body: datos\n                });\n\n                // Esperar la respuesta en formato JSON\n                const resultado = await respuesta.json();\n                mostrarAlerta(resultado.titulo, resultado.mensaje, resultado.tipo);\n                \n            } catch (error) {\n                console.log('Error en la solicitud:', error);\n            }\n\n        });\n    }\n\n    function mostrarAlerta(titulo, mensaje, tipo) {\n        Swal.fire({\n            icon: tipo,\n            title: titulo,\n            text: mensaje,\n        }).then(() => {\n            $('.modal').modal('hide'); // Cierra todos los modales activos\n        });\n    }    \n\n    function mostrarAlerta2(mensaje, tipo) {\n        const mensajeResultado = document.getElementById('mensaje-resultado');\n        mensajeResultado.style.display = 'block'; // Asegúrate de que el contenedor se muestre\n        mensajeResultado.textContent = mensaje; // Mostrar solo el mensaje\n    \n        // Cambiar el color de fondo del contenedor según el tipo de mensaje\n        if (tipo === 'error') {\n            mensajeResultado.className = 'alert alert-danger'; // Rojo para error\n        } else if (tipo === 'success') {\n            mensajeResultado.className = 'alert alert-success'; // Verde para éxito\n        } else {\n            mensajeResultado.className = 'alert alert-info'; // Azul o información por defecto\n        }\n    \n        // Opcional: Ocultar el mensaje después de 5 segundos\n        setTimeout(() => {\n            mensajeResultado.style.display = 'none';\n        }, 5000);\n    }\n    \n}\n","if (window.location.pathname === '/admin/usuarios') {\n    let dataTable;\n    let dataTableInit = false;\n\n    // Diccionarios para roles y estatus\n    const rolesDictionary = {\n        1: 'Administrador',\n        2: 'General',\n        3: 'Limpieza'\n    };\n\n    const estatusDictionary = {\n        0: 'Inactivo',\n        1: 'Activo'\n    };\n\n    // Configuración DataTable\n    const dataTableOption = {\n        destroy: true,\n        pageLength: 5,\n        language: {\n            url: 'https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json',\n        },\n        dom: '<\"row mb-2\"<\"d-flex justify-content-start col-sm-6\"f>>' +  \n             '<\"row\"<\"col-sm-12\"tr>>' + \n             '<\"row d-flex justify-content-between\"<\"col d-flex justify-content-start\"l><\"col d-flex justify-content-center\"i><\"col d-flex justify-content-end\"p>>',\n        columnDefs: [\n            { orderable: false, targets: [3, 8] },  // Desactiva ordenación en Dirección y Estatus\n            { visible: false, targets: [7] }       // Oculta la columna Password\n        ]\n    };\n\n    // Ejecutar funciones\n    initDataTable();\n\n    // Inicializamos DataTable\n    async function initDataTable() {\n        if (dataTableInit) {\n            dataTable.destroy(); // Destruye la tabla si ya existe previamente\n        }\n\n        const usuarios = await listarUsers(); // Esperamos los datos antes de inicializar DataTable\n\n        if (usuarios.length > 0) {\n            llenarTabla(usuarios);\n        }\n\n        // Inicializa DataTable\n        dataTable = $('#datatable_users').DataTable(dataTableOption);\n        dataTableInit = true;\n    }\n\n    // Función para obtener los datos de la API\n    async function listarUsers() {\n        try {\n            const response = await fetch('/api/usuarios');\n            const data = await response.json();\n            return data;\n        } catch (error) {\n            console.error('Error al obtener usuarios:', error);\n            return [];\n        }\n    }\n\n    // Función para llenar la tabla con los datos obtenidos\n    function llenarTabla(usuarios) {\n        const tbody = document.getElementById('tableBody_users');\n        tbody.innerHTML = ''; // Limpiamos el contenido previo\n\n        usuarios.forEach((user, index) => {\n            const rol = rolesDictionary[user.rol_id] || 'Desconocido';\n            const estatus = estatusDictionary[user.estatus] || 'Desconocido';\n\n            const row = `\n                <tr>\n                    <td>${index + 1}</td>\n                    <td><img src=\"/build/img/${user.img}.png\" alt=\"Descripción de la imagen\" width=\"65\"></td>\n                    <td>${user.nombre}</td>\n                    <td>${user.apellido}</td>\n                    <td>${user.direccion}</td>\n                    <td>${user.email}</td>\n                    <td>${user.telefono}</td>\n                    <td>******</td> <!-- Ocultamos la contraseña en opciones de la tabla -->\n                    <td>${rol}</td>\n                    <td class=\"text-center\">${estatus}</td>\n                    <td>\n                        <!-- Botón de editar que abre el modal -->\n                        <button \n                            class=\"btn btn-sm btn-primary btn-editarUsuario\"\n                            data-id=\"${user.id}\" \n                            data-toggle=\"modal\" \n                            data-target=\"#usuariosModal\">\n                            <i class=\"fa-solid fa-pen\"></i>\n                        </button>\n                        <!-- Botón de eliminar -->\n                        <button class=\"btn btn-sm btn-danger btn-eliminarUsuario\" data-id=\"${user.id}\">\n                            <i class=\"fa-solid fa-trash\"></i>\n                        </button>\n                    </td>\n                </tr>\n            `;\n            tbody.innerHTML += row;\n        });\n\n        tbody.addEventListener('click', function(e){\n            //Delegacion para actualizar el cliente\n            if( e.target.closest('.btn-editarUsuario') ){\n                // Cambiar la clase del botón para que sea de 'Actualizar' y no de 'Crear'\n                const botonSubirUsuario = document.querySelector('.btnSubirUsuario');\n                if ( botonSubirUsuario ){\n                    botonSubirUsuario.classList.replace('btnSubirUsuario','btnActualizarUsuario');\n                }\n\n                const usuarioId = e.target.closest('.btn-editarUsuario').getAttribute('data-id');\n                cargarDatosUsuario(usuarioId); //Llama a la funcion de cargar los datos\n            }\n            if (e.target.classList.contains('btn-eliminarUsuario')) {\n                const usuarioId = e.target.getAttribute('data-id');\n                confirmarEliminacion(usuarioId);\n            }            \n        })\n\n        async function confirmarEliminacion(id) {\n            Swal.fire({\n                title: '¿Estás seguro?',\n                text: \"Esta acción no se puede deshacer.\",\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonColor: '#d33',\n                cancelButtonColor: '#3085d6',\n                confirmButtonText: 'Sí, eliminar',\n                cancelButtonText: 'Cancelar'\n            }).then(async (result) => {\n                if (result.isConfirmed) {\n                    try {\n                        const url = `/api/usuarios/${id}`; // 🔥 Aquí se inyecta el ID en la URL\n        \n                        const respuesta = await fetch(url, {\n                            method: 'DELETE',  // 🔥 Método DELETE para eliminar\n                        });\n        \n                        const resultado = await respuesta.json();\n                        mostrarAlerta(resultado.titulo, resultado.mensaje, resultado.tipo);\n        \n                        if (resultado.tipo === 'success') {\n                            await initDataTable(); // Recarga la tabla de clientes\n                        }\n                    } catch (error) {\n                        console.error(error);\n                    }\n                }\n            });\n        }        \n    }\n\n    async function cargarDatosUsuario(id) {\n        try {\n            const url = `/api/usuarios/${id}`;\n            const resultado = await fetch(url);\n    \n            if (resultado.ok) {\n                const usuario = await resultado.json();\n                console.log(usuario);\n                llenarModal(usuario);\n    \n                let btnActualizarUsuario = document.querySelector('.btnActualizarUsuario');\n    \n                if (btnActualizarUsuario) {\n                    // Eliminar eventos previos correctamente\n                    let nuevoBtn = btnActualizarUsuario.cloneNode(true);\n                    btnActualizarUsuario.replaceWith(nuevoBtn);\n                    btnActualizarUsuario = document.querySelector('.btnActualizarUsuario');\n    \n                    btnActualizarUsuario.addEventListener('click', async function (e) {\n                        e.preventDefault();\n    \n                        // Obtener los valores actualizados\n                        const usuarioactualizado = {\n                            nombre: document.getElementById('nombre').value.trim(),\n                            apellido: document.getElementById('apellido').value.trim(),\n                            direccion: document.getElementById('direccion').value.trim(),\n                            email: document.getElementById('email').value.trim(),\n                            telefono: document.getElementById('telefono').value.trim(),\n                            password: document.getElementById('password').value.trim(),\n                            password2: document.getElementById('password2').value.trim(),\n                            rol_id: document.getElementById('rol_id').value.trim(),\n                            estatus: document.getElementById('estatus').value.trim(),\n                            img: document.getElementById('logo').files[0] || usuario.img // Si no se carga imagen, mantener la existente\n                        };\n    \n                        // **Validación de contraseñas**\n                        if (usuarioactualizado.password || usuarioactualizado.password2) {\n                            if (usuarioactualizado.password !== usuarioactualizado.password2) {\n                                mostrarAlerta2(\"Las contraseñas no coinciden.\", \"error\");\n                                return; // Detiene la ejecución si las contraseñas no coinciden\n                            }\n                        }\n    \n                        // **Validación de email**\n                        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n                        if (!emailRegex.test(usuarioactualizado.email)) {\n                            mostrarAlerta2(\"El correo electrónico no tiene un formato válido.\", \"error\");\n                            return; // Detiene la ejecución si el email no es válido\n                        }\n    \n                        let cambios = {};\n    \n                        if (usuarioactualizado.nombre !== usuario.nombre) cambios.nombre = usuarioactualizado.nombre;\n                        if (usuarioactualizado.apellido !== usuario.apellido) cambios.apellido = usuarioactualizado.apellido;\n                        if (usuarioactualizado.direccion !== usuario.direccion) cambios.direccion = usuarioactualizado.direccion;\n                        if (usuarioactualizado.email !== usuario.email) cambios.email = usuarioactualizado.email;\n                        if (usuarioactualizado.estatus !== usuario.estatus) cambios.estatus = usuarioactualizado.estatus;\n                        if (usuarioactualizado.telefono !== usuario.telefono) cambios.telefono = usuarioactualizado.telefono;\n                        if (usuarioactualizado.password && usuarioactualizado.password2) {\n                            cambios.password = usuarioactualizado.password;\n                        }\n                        if (usuarioactualizado.rol_id !== usuario.rol_id) cambios.rol_id = usuarioactualizado.rol_id;\n                        \n                        // Si se seleccionó una imagen nueva, incluirla\n                        if (usuarioactualizado.img instanceof File) {\n                            cambios.img = usuarioactualizado.img;\n                        }\n\n                        delete usuarioactualizado.password2;\n\n                        //console.log(cambios);\n    \n                        if (Object.keys(cambios).length > 0) {\n                            try {\n                                const datos = new FormData();\n                                Object.entries(usuarioactualizado).forEach(([key, value]) => datos.append(key, value));\n                                const url = `/api/usuarios/${id}`; \n                                const respuesta = await fetch(url, { // Corregido: Usar un objeto en lugar de un array\n                                    method: 'POST',\n                                    body: datos\n                                });\n                                \n                                // Esperar la respuesta en formato JSON\n                                const resultado = await respuesta.json();\n                                mostrarAlerta(resultado.titulo, resultado.mensaje, resultado.tipo);\n                            } catch (error) {\n                                console.log(error);\n                            }\n                            \n                        } else {\n                            mostrarAlerta('Sin Cambios', 'No hay cambios por mostrar', 'warning')\n                        }    \n                        // Aquí iría tu función de envío de datos al servidor\n                    });\n                }\n            }\n    \n            function llenarModal(usuario) {\n                document.getElementById('nombre').value = usuario.nombre;\n                document.getElementById('apellido').value = usuario.apellido;\n                document.getElementById('direccion').value = usuario.direccion;\n                document.getElementById('email').value = usuario.email;\n                document.getElementById('telefono').value = usuario.telefono;\n                document.getElementById('rol_id').value = usuario.rol_id;\n                document.getElementById('estatus').value = usuario.estatus;\n    \n                const imgElement = document.getElementById('img');\n                imgElement.src = `/build/img/${usuario.img}.png`;\n            }\n    \n        } catch (error) {\n            console.error(error);\n        }\n    }\n\n    function mostrarAlerta(titulo, mensaje, tipo) {\n        Swal.fire({\n            icon: tipo,\n            title: titulo,\n            text: mensaje,\n        }).then(() => {\n            $('.modal').modal('hide'); // Cierra todos los modales activos\n        });\n    }\n    \n    function mostrarAlerta2(mensaje, tipo) {\n        const mensajeResultado = document.getElementById('mensaje-resultado');\n        mensajeResultado.style.display = 'block'; // Asegúrate de que el contenedor se muestre\n        mensajeResultado.textContent = mensaje; // Mostrar solo el mensaje\n    \n        // Cambiar el color de fondo del contenedor según el tipo de mensaje\n        if (tipo === 'error') {\n            mensajeResultado.className = 'alert alert-danger'; // Rojo para error\n        } else if (tipo === 'success') {\n            mensajeResultado.className = 'alert alert-success'; // Verde para éxito\n        } else {\n            mensajeResultado.className = 'alert alert-info'; // Azul o información por defecto\n        }\n    \n        // Opcional: Ocultar el mensaje después de 5 segundos\n        setTimeout(() => {\n            mensajeResultado.style.display = 'none';\n        }, 5000);\n    }\n}\n"]}