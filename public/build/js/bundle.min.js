if("/login"===window.location.pathname){const t=document.getElementById("btnIniciarSesion");function mostrarAlerta2(t,e){const a=document.getElementById("mensaje-resultado");a.style.display="block",a.textContent=t,a.className="error"===e?"alert alert-danger":"success"===e?"alert alert-success":"alert alert-info",setTimeout(()=>{a.style.display="none"},5e3)}t&&t.addEventListener("click",(async function(t){t.preventDefault();const e={email:document.getElementById("email").value.trim(),password:document.getElementById("password").value.trim()};if(""!==e.email&&""!==e.password)try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a="http://localhost:3000/login",n=await fetch(a,{method:"POST",body:t}),o=await n.json();o.autorizado?window.location.href="/admin/index":mostrarAlerta2(o.mensaje,o.tipo)}catch(t){console.log(t)}else mostrarAlerta2("Todos los campos son obligatorios","error")}))}if("/registro"===window.location.pathname){const t=document.getElementById("crear-cuenta");function mostrarAlerta(t,e,a){Swal.fire({icon:a,title:t,text:e}).then(()=>{$(".modal").modal("hide")})}function mostrarAlerta2(t,e){const a=document.getElementById("mensaje-resultado");a.style.display="block",a.textContent=t,a.className="error"===e?"alert alert-danger":"success"===e?"alert alert-success":"alert alert-info",setTimeout(()=>{a.style.display="none"},5e3)}t&&t.addEventListener("click",(async function(t){t.preventDefault();const e={nombre:document.getElementById("nombre").value.trim(),apellidos:document.getElementById("apellidos").value.trim(),email:document.getElementById("email").value.trim(),password:document.getElementById("password").value.trim(),password2:document.getElementById("password2").value.trim(),telefono:document.getElementById("telefono").value.trim(),direccion:document.getElementById("direccion").value.trim()};if(""!==e.email&&""!==e.nombre&&""!==e.direccion&&""!==e.password&&""!==e.password2&&""!==e.telefono)if(e.password===e.password2){delete e.password2;try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a="http://localhost:3000/registro",n=await fetch(a,{method:"POST",body:t}),o=await n.json();mostrarAlerta(o.titulo,o.mensaje,o.tipo)}catch(t){console.log("Error en la solicitud:",t)}}else mostrarAlerta2("Las contraseñas no coinciden","error");else mostrarAlerta2("Todos los campos son necesarios","error")}))}if("/admin/usuarios"===window.location.pathname){let t,e=!1;const a={1:"Administrador",2:"General",3:"Limpieza"},n={0:"Inactivo",1:"Activo"},o={destroy:!0,pageLength:5,language:{url:"https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json"},dom:'<"row mb-2"<"d-flex justify-content-start col-sm-6"f>><"row"<"col-sm-12"tr>><"row d-flex justify-content-between"<"col d-flex justify-content-start"l><"col d-flex justify-content-center"i><"col d-flex justify-content-end"p>>',columnDefs:[{orderable:!1,targets:[3,8]},{visible:!1,targets:[5]}]};async function initDataTable(){e&&t.destroy();const a=await listarUsers();a.length>0&&llenarTabla(a),t=$("#datatable_users").DataTable(o),e=!0}async function listarUsers(){try{const t=await fetch("/api/usuarios");return await t.json()}catch(t){return console.error("Error al obtener usuarios:",t),[]}}function llenarTabla(t){const e=document.getElementById("tableBody_users");e.innerHTML="",t.forEach((t,o)=>{const s=a[t.rol_id]||"Desconocido",r=n[t.estatus]||"Desconocido",i=`\n                <tr>\n                    <td>${o+1}</td>\n                    <td>${t.nombre}</td>\n                    <td>${t.apellido}</td>\n                    <td>${t.direccion}</td>\n                    <td>${t.email}</td>\n                    <td>******</td> \x3c!-- Ocultamos la contraseña --\x3e\n                    <td>${s}</td>\n                    <td class="text-center">${r}</td>\n                    <td>\n                        \x3c!-- Botón de editar que abre el modal --\x3e\n                        <button \n                            class="btn btn-sm btn-primary btn-editarUsuario"\n                            data-id="${t.id}" \n                            data-toggle="modal" \n                            data-bs-target="#UsuarioModal">\n                            <i class="fa-solid fa-pen"></i>\n                        </button>\n                        \x3c!-- Botón de eliminar --\x3e\n                        <button class="btn btn-sm btn-danger btn-eliminarUsuario" data-id="${t.id}">\n                            <i class="fa-solid fa-trash"></i>\n                        </button>\n                    </td>\n                </tr>\n            `;e.innerHTML+=i}),e.addEventListener("click",(function(t){if(t.target.closest(".btn-editarUsuario")){const e=document.querySelector(".btnSubirUsuario");e&&e.classList.replace("btnSubirUsuario","btnActualizarUusuario");const a=t.target.closest(".btn-editarUsuario").getAtribute("data-id");cargarDatosUsuario(a)}if(t.target.classList.contains("btn-eliminarUsuario")){!async function(t){Swal.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(async e=>{if(e.isConfirmed)try{const e="http://localhost:3000/api/usuarios/"+t,a=await fetch(e,{method:"DELETE"}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),"success"===n.tipo&&await initDataTable()}catch(t){console.error(t)}})}(t.target.getAttribute("data-id"))}}))}function mostrarAlerta(t,e,a){Swal.fire({icon:a,title:t,text:e}).then(()=>{$(".modal").modal("hide")})}initDataTable()}
//# sourceMappingURL=bundle.js.map
