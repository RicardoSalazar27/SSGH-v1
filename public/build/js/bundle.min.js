if("/admin/configuracion/informacion"===window.location.pathname){const t=document.getElementById("btnActualizarInfo");function mostrarAlerta(t,e,a){Swal.fire({icon:a,title:t,text:e}).then(()=>{$(".modal").modal("hide"),location.reload()})}t&&t.addEventListener("click",(async function(e){e.preventDefault();const a={id:t.dataset.id,nombre:document.getElementById("nombre").value.trim(),telefono:document.getElementById("telefono").value.trim(),correo:document.getElementById("correo").value.trim(),ubicacion:document.getElementById("ubicacion").value.trim(),img:document.getElementById("logo").files[0]};try{const t=new FormData;Object.entries(a).forEach(([e,a])=>t.append(e,a));const e="/admin/configuracion/informacion/actualizar",n=await fetch(e,{method:"POST",body:t}),o=await n.json();mostrarAlerta(o.titulo,o.mensaje,o.tipo)}catch(t){console.log("error")}}))}if(window.mostrarAlerta=function(t,e,a){Swal.fire({icon:a,title:t,text:e}).then(()=>{$(".modal").modal("hide")})},window.mostrarAlerta2=function(t,e){const a=document.getElementById("mensaje-resultado");a.style.display="block",a.textContent=t,a.className="alert alert-"+("error"===e?"danger":"success"===e?"success":"info"),setTimeout(()=>{a.style.display="none"},5e3)},"/login"===window.location.pathname){const t=document.getElementById("btnIniciarSesion");t&&t.addEventListener("click",(async function(t){t.preventDefault();const e={email:document.getElementById("email").value.trim(),password:document.getElementById("password").value.trim()};if(""!==e.email&&""!==e.password)try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a="http://localhost:3000/login",n=await fetch(a,{method:"POST",body:t}),o=await n.json();o.autorizado?window.location.href="/admin/index":mostrarAlerta2(o.mensaje,o.tipo)}catch(t){console.log(t)}else mostrarAlerta2("Todos los campos son obligatorios","error")}))}if("/admin/configuracion/categorias"===window.location.pathname){let t,e=!1;const a={0:"Inactivo",1:"Activo"},n={destroy:!0,pageLength:5,language:{url:"https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json"},dom:'<"row mb-2"<"d-flex justify-content-start col-sm-6"f>><"row"<"col-sm-12"tr>><"row d-flex justify-content-between"<"col d-flex justify-content-start"l><"col d-flex justify-content-center"i><"col d-flex justify-content-end"p>>',columnDefs:[{orderable:!1,targets:[7]}]};async function initDataTable(){e&&t.destroy();const a=await listarCategorias();a.length>0&&llenarTabla(a),t=$("#datatable_categorias").DataTable(n),e=!0}async function listarCategorias(){try{const t=await fetch("/api/categorias");if(204===t.status)return[];if(!t.ok)throw new Error("Error HTTP: "+t.status);return await t.json()}catch(t){return console.error("Error al obtener categorías:",t),null}}function llenarTabla(t){const e=document.getElementById("tableBody_categorias");e.innerHTML="",t.forEach((t,n)=>{const o=a[t.estado]||"Desconocido",r=`\n                <tr>\n                    <td>${n+1}</td>\n                    <td>${t.nombre}</td>\n                    <td class="text-center">${t.capacidad_maxima}</td>\n                    <td>${t.tipo_cama}</td>\n                    <td>${t.precio_base}</td>\n                    <td>${t.servicios_incluidos}</td>\n                    <td>${o}</td>\n                    <td>\n                        \x3c!-- Botón de editar que abre el modal --\x3e\n                        <button \n                            class="btn btn-sm btn-primary btnEditarCategoria" \n                            data-id="${t.id}" \n                            data-toggle="modal" \n                            data-target="#modalEditarCategoria">\n                            <i class="fa-solid fa-pen"></i>\n                        </button>\n                        \x3c!-- Botón de eliminar --\x3e\n                        <button class="btn btn-sm btn-danger btn-eliminarCategoria" data-id="${t.id}">\n                            <i class="fa-solid fa-trash"></i>\n                        </button>\n                    </td>\n                </tr>\n            `;e.innerHTML+=r})}initDataTable(),document.getElementById("tableBody_categorias").addEventListener("click",(async function(t){if(t.target.closest(".btn-eliminarCategoria")){const e=t.target.closest(".btn-eliminarCategoria").getAttribute("data-id");if((await Swal.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{const t="/api/categorias/"+e,a=await fetch(t,{method:"DELETE"}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),"success"===n.tipo&&await initDataTable()}catch(t){console.error(t)}}}));let o=null;document.addEventListener("click",(async function(t){if(t.target.closest(".btnEditarCategoria")){const e=t.target.closest(".btnEditarCategoria").dataset.id;o=null;try{const t="/api/categorias/"+e,a=await fetch(t);if(!a.ok)throw new Error("Error al obtener categoria: "+a.statusText);const n=await a.json();o={...n},document.getElementById("nombreEditar").value=n.nombre,document.getElementById("capacidad_maximaEditar").value=n.capacidad_maxima,document.getElementById("tipo_camaEditar").value=n.tipo_cama,document.getElementById("precio_baseEditar").value=n.precio_base,document.getElementById("servicios_incluidosEditar").value=n.servicios_incluidos,document.getElementById("estadoEditar").value=n.estado,document.querySelector(".btnActualizarCategoria").dataset.id=e}catch(t){console.log("Error al obtener los datos de la categoria:",t)}}})),document.getElementById("formEditarCategoria").addEventListener("submit",(async function(t){t.preventDefault();const e=document.querySelector(".btnActualizarCategoria").dataset.id,a={nombre:document.getElementById("nombreEditar").value.trim(),capacidad_maxima:document.getElementById("capacidad_maximaEditar").value.trim(),tipo_cama:document.getElementById("tipo_camaEditar").value.trim(),precio_base:document.getElementById("precio_baseEditar").value.trim(),servicios_incluidos:document.getElementById("servicios_incluidosEditar").value.trim(),estado:document.getElementById("estadoEditar").value.trim()};if(!o)return console.error("Error: No hay datos originales de la categoria"),void mostrarAlerta("Error","No se pudieron comparar los datos originales","error");let n={};if(a.nombre!==o.nombre&&(n.nombre=a.nombre),a.capacidad_maxima!==o.capacidad_maxima&&(n.capacidad_maxima=a.capacidad_maxima),a.tipo_cama!==o.tipo_cama&&(n.tipo_cama=a.tipo_cama),a.precio_base!==o.precio_base&&(n.precio_base=a.precio_base),a.servicios_incluidos!==o.servicios_incluidos&&(n.servicios_incluidos=a.servicios_incluidos),a.estado!==o.estado&&(n.estado=a.estado),0===Object.keys(n).length)return void mostrarAlerta2("No hay cambios por enviar","error");const r=6===Object.keys(n).length?"PUT":"PATCH",i="PUT"===r?a:n;try{const t="/api/categorias/"+e,a=await fetch(t,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!a.ok){const t=await respuestaUpdate.json();throw new Error(t.mensaje||"Error desconocido al actualizar")}const n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),initDataTable()}catch(t){console.error("Error al actualizar nivel:",t),mostrarAlerta("Error",t.message,"error")}}));document.querySelector(".btnSubirCategoria").addEventListener("click",(async function(t){t.preventDefault();const e={nombre:document.getElementById("nombre").value.trim(),capacidad_maxima:document.getElementById("capacidad_maxima").value.trim(),tipo_cama:document.getElementById("tipo_cama").value.trim(),precio_base:document.getElementById("precio_base").value.trim(),servicios_incluidos:document.getElementById("servicios_incluidos").value.trim(),estado:document.getElementById("estado").value.trim()};if(""!==e.nombre&&""!==e.capacidad_maxima&&""!==e.tipo_cama&&""!==e.precio_base)try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a=await fetch("/api/categorias",{method:"POST",body:t}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),initDataTable(),document.getElementById("nombre").value="",document.getElementById("capacidad_maxima").value="",document.getElementById("tipo_cama").value="",document.getElementById("servicios_incluidos").value="",document.getElementById("precio_base").value="",document.getElementById("estatado").value=""}catch(t){console.error("Error en la solicitud:",t)}else mostrarAlerta2("Todos los campos son necesarios","error")}))}if("/admin/clientes"===window.location.pathname){let t,e=!1;const a={destroy:!0,pageLength:5,language:{url:"https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json"},dom:'<"row mb-2"<"d-flex justify-content-start col-sm-6"f>><"row"<"col-sm-12"tr>><"row d-flex justify-content-between"<"col d-flex justify-content-start"l><"col d-flex justify-content-center"i><"col d-flex justify-content-end"p>>',columnDefs:[{orderable:!1,targets:[6,7]}]};async function initDataTable(){e&&t.destroy();const n=await listarClientes();n.length>0&&llenarTabla(n),t=$("#datatable_clientes").DataTable(a),e=!0}async function listarClientes(){try{const t=await fetch("/api/clientes");if(204===t.status)return[];if(!t.ok)throw new Error("Error HTTP: "+t.status);return await t.json()}catch(t){return console.error("Error al obtener clientes:",t),null}}function llenarTabla(t){const e=document.getElementById("tableBody_clientes");e.innerHTML="",t.forEach((t,a)=>{const n=`\n                <tr>\n                    <td>${a+1}</td>\n                    <td>${t.nombre}</td>\n                    <td>${t.apellidos}</td>\n                    <td>${t.telefono}</td>\n                    <td>${t.correo}</td>\n                    <td>${t.direccion}</td>\n                    <td>${t.documento_identidad}</td>\n                    <td>\n                        \x3c!-- Botón de editar que abre el modal --\x3e\n                        <button \n                            class="btn btn-sm btn-primary btnEditarCliente" \n                            data-id="${t.id}" \n                            data-toggle="modal" \n                            data-target="#modalEditarCliente">\n                            <i class="fa-solid fa-pen"></i>\n                        </button>\n                        \x3c!-- Botón de eliminar --\x3e\n                        <button class="btn btn-sm btn-danger btn-eliminarCliente" data-id="${t.id}">\n                            <i class="fa-solid fa-trash"></i>\n                        </button>\n                    </td>\n                </tr>\n            `;e.innerHTML+=n})}initDataTable();let n=null;document.addEventListener("click",(async function(t){if(t.target.closest(".btnEditarCliente")){const e=t.target.closest(".btnEditarCliente").dataset.id;n="";try{const t=await fetch("/api/clientes/"+e);if(!t.ok)throw new Error("Error al obtener cliente: "+t.statusText);const a=await t.json();n={...a},document.getElementById("nombre").value=a.nombre,document.getElementById("apellidos").value=a.apellidos,document.getElementById("direccion").value=a.direccion,document.getElementById("correo").value=a.correo,document.getElementById("telefono").value=a.telefono,document.getElementById("documento_identidad").value=a.documento_identidad,document.querySelector(".btnActualizarCliente").dataset.id=e}catch(t){console.error("Error al obtener los datos del cliente:",t)}}})),document.getElementById("formEditarCliente").addEventListener("submit",(async function(t){t.preventDefault();document.querySelector(".btnActualizarCliente").dataset.id;const e={nombre:document.getElementById("nombre").value.trim(),apellidos:document.getElementById("apellidos").value.trim(),telefono:document.getElementById("telefono").value.trim(),correo:document.getElementById("correo").value.trim(),direccion:document.getElementById("direccion").value.trim(),documento_identidad:document.getElementById("documento_identidad").value.trim()};if(!n)return console.error("Error: No hay datos originales del cliente"),void mostrarAlerta("Error","No se pudieron comparar los datos originales","error");let a={};if(e.nombre!==nivelOriginal.nombre&&(a.nombre=e.nombre),e.apellidos!==nivelOriginal.apellidos&&(a.apellidos=e.apellidos),e.telefono!==nivelOriginal.telefono&&(a.telefono=e.telefono),e.correo!==nivelOriginal.correo&&(a.correo=e.correo),e.direccion!==nivelOriginal.direccion&&(a.direccion=e.direccion),e.documento_identidad!==nivelOriginal.documento_identidad&&(a.documento_identidad=e.documento_identidad),0===Object.keys(a).length)return void mostrarAlerta2("No hay cambios por enviar","error");const o=3===Object.keys(a).length?"PUT":"PATCH",r="PUT"===o?clienteActualizadoActualizado:a;console.log(r)}))}if("/admin/configuracion/habitaciones"===window.location.pathname){let t,e=!1;const a={0:"Inactivo",1:"Activo"},n={destroy:!0,pageLength:5,language:{url:"https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json"},dom:'<"row mb-2"<"d-flex justify-content-start col-sm-6"f>><"row"<"col-sm-12"tr>><"row d-flex justify-content-between"<"col d-flex justify-content-start"l><"col d-flex justify-content-center"i><"col d-flex justify-content-end"p>>',columnDefs:[{orderable:!1,targets:[4]}]};async function initDataTable(){e&&t.destroy();const a=await listarhabitaciones();a.length>0&&llenarTabla(a),t=$("#datatable_habitaciones").DataTable(n),e=!0}async function listarhabitaciones(){try{const t=await fetch("/api/habitaciones");return await t.json()}catch(t){return console.error("Error al obtener habitaciones:",t),[]}}function llenarTabla(t){const e=document.getElementById("tableBody_habitaciones");e.innerHTML="",t.forEach(t=>{const n=a[t.estatus]||"Desconocido",o=`\n                <tr>\n                    <td>${t.numero}</td>\n                    <td>${t.id_nivel.nombre}</td>\n                    <td>${t.id_categoria.nombre}</td>\n                    <td>${t.id_categoria.precio_base}</td>\n                    <td>${t.id_categoria.servicios_incluidos}</td>\n                    <td>${t.detalles_personalizados}</td>\n                    <td class="text-center">${n}</td>\n                    <td>\n                        \x3c!-- Botón de editar que abre el modal --\x3e\n                        <button \n                            class="btn btn-sm btn-primary btnEditarHabitacion" \n                            data-id="${t.id}" \n                            data-toggle="modal" \n                            data-target="#modalEditarHabitacion">\n                            <i class="fa-solid fa-pen"></i>\n                        </button>\n                        \x3c!-- Botón de eliminar --\x3e\n                        <button class="btn btn-sm btn-danger btn-eliminarHabitacion" data-id="${t.id}">\n                            <i class="fa-solid fa-trash"></i>\n                        </button>\n                    </td>\n                </tr>\n            `;e.innerHTML+=o})}initDataTable(),document.getElementById("tableBody_habitaciones").addEventListener("click",(async function(t){if(t.target.closest(".btn-eliminarHabitacion")){const e=t.target.closest(".btn-eliminarHabitacion").getAttribute("data-id");if((await Swal.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{const t="/api/habitaciones/"+e,a=await fetch(t,{method:"DELETE"}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),"success"===n.tipo&&await initDataTable()}catch(t){console.error(t)}}}));let o=null;document.addEventListener("click",(async function(t){if(t.target.closest(".btnEditarHabitacion")){const e=t.target.closest(".btnEditarHabitacion").dataset.id;o="";try{const t=await fetch("/api/habitaciones/"+e);if(!t.ok)throw new Error("Error al obtener habitación: "+t.statusText);const a=await t.json();console.log(a),o={...a},document.getElementById("numeroEditar").value=a.numero,document.getElementById("id_nivelEditar").value=a.id_nivel.id,document.getElementById("id_categoriaEditar").value=a.id_categoria.id,document.getElementById("detalles_personalizadosEditar").value=a.detalles_personalizados,document.getElementById("estatusEditar").value=a.estatus,document.querySelector(".btnActualizarHabitacion").dataset.id=e}catch(t){console.error("Error al obtener los datos de la habitación:",t)}}})),document.getElementById("formEditarHabitacion").addEventListener("submit",(async function(t){t.preventDefault();const e=document.querySelector(".btnActualizarHabitacion").dataset.id,a={numero:document.getElementById("numeroEditar").value.trim(),id_nivel:document.getElementById("id_nivelEditar").value.trim(),id_categoria:document.getElementById("id_categoriaEditar").value.trim(),detalles_personalizados:document.getElementById("detalles_personalizadosEditar").value.trim(),estatus:document.getElementById("estatusEditar").value.trim()};if(!o)return console.error("Error: No hay datos originales del habitacion"),void mostrarAlerta("Error","No se pudieron comparar los datos originales","error");let n={};if(a.numero!==o.numero&&(n.numero=a.numero),a.id_nivel!==o.id_nivel&&(n.id_nivel=a.id_nivel),a.id_categoria!==o.id_categoria&&(n.id_categoria=a.id_categoria),a.detalles_personalizados!==o.detalles_personalizados&&(n.detalles_personalizados=a.detalles_personalizados),a.estatus!==o.estatus&&(n.estatus=a.estatus),0===Object.keys(n).length)return void mostrarAlerta2("No hay cambios por enviar","error");const r=a;try{const t=await fetch("/api/habitaciones/"+e,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!t.ok){const e=await t.json();throw new Error(e.mensaje||"Error desconocido al actualizar")}const a=await t.json();mostrarAlerta(a.titulo,a.mensaje,a.tipo),initDataTable()}catch(t){console.error("Error al actualizar habitacion:",t),mostrarAlerta("Error",t.message,"error")}}));document.querySelector(".btnSubirHabitacion").addEventListener("click",(async function(t){t.preventDefault();const e={numero:document.getElementById("numero").value.trim(),id_nivel:document.getElementById("id_nivel").value.trim(),id_categoria:document.getElementById("id_categoria").value.trim(),detalles_personalizados:document.getElementById("detalles_personalizados").value.trim(),estatus:document.getElementById("estatus").value.trim()};if(""!==e.id_nivel&&""!==e.numero&&""!==e.id_categoria)try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a=await fetch("/api/habitaciones",{method:"POST",body:t}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),initDataTable(),document.getElementById("numero").value="",document.getElementById("detalles_personalizados").value="",document.getElementById("estatus").value="1"}catch(t){console.error("Error en la solicitud:",t)}else mostrarAlerta2("Todos los campos son necesarios","error")}))}if("/admin/configuracion/niveles"===window.location.pathname){let t,e=!1;const a={0:"Inactivo",1:"Activo"},n={destroy:!0,pageLength:5,language:{url:"https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json"},dom:'<"row mb-2"<"d-flex justify-content-start col-sm-6"f>><"row"<"col-sm-12"tr>><"row d-flex justify-content-between"<"col d-flex justify-content-start"l><"col d-flex justify-content-center"i><"col d-flex justify-content-end"p>>',columnDefs:[{orderable:!1,targets:[4]}]};async function initDataTable(){e&&t.destroy();const a=await listarNiveles();a.length>0&&llenarTabla(a),t=$("#datatable_niveles").DataTable(n),e=!0}async function listarNiveles(){try{const t=await fetch("/api/niveles");return await t.json()}catch(t){return console.error("Error al obtener niveles:",t),[]}}function llenarTabla(t){const e=document.getElementById("tableBody_niveles");e.innerHTML="",t.forEach((t,n)=>{const o=a[t.estatus]||"Desconocido",r=`\n                <tr>\n                    <td>${n+1}</td>\n                    <td>${t.nombre}</td>\n                    <td>${t.numero}</td>\n                    <td class="text-center">${o}</td>\n                    <td>\n                        \x3c!-- Botón de editar que abre el modal --\x3e\n                        <button \n                            class="btn btn-sm btn-primary btnEditarNivel" \n                            data-id="${t.id}" \n                            data-toggle="modal" \n                            data-target="#modalEditarNivel">\n                            <i class="fa-solid fa-pen"></i>\n                        </button>\n                        \x3c!-- Botón de eliminar --\x3e\n                        <button class="btn btn-sm btn-danger btn-eliminarNivel" data-id="${t.id}">\n                            <i class="fa-solid fa-trash"></i>\n                        </button>\n                    </td>\n                </tr>\n            `;e.innerHTML+=r})}initDataTable(),document.getElementById("tableBody_niveles").addEventListener("click",(async function(t){if(t.target.closest(".btn-eliminarNivel")){const e=t.target.closest(".btn-eliminarNivel").getAttribute("data-id");if((await Swal.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{const t="/api/niveles/"+e,a=await fetch(t,{method:"DELETE"}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),"success"===n.tipo&&await initDataTable()}catch(t){console.error(t)}}}));let o=null;document.addEventListener("click",(async function(t){if(t.target.closest(".btnEditarNivel")){const e=t.target.closest(".btnEditarNivel").dataset.id;o="";try{const t=await fetch("/api/niveles/"+e);if(!t.ok)throw new Error("Error al obtener nivel: "+t.statusText);const a=await t.json();o={...a},document.getElementById("nombreEditar").value=a.nombre,document.getElementById("numeroEditar").value=a.numero,document.getElementById("estatusEditar").value=a.estatus,document.querySelector(".btnActualizarNivel").dataset.id=e}catch(t){console.error("Error al obtener los datos del nivel:",t)}}})),document.getElementById("formEditarNivel").addEventListener("submit",(async function(t){t.preventDefault();const e=document.querySelector(".btnActualizarNivel").dataset.id,a={nombre:document.getElementById("nombreEditar").value.trim(),numero:document.getElementById("numeroEditar").value.trim(),estatus:document.getElementById("estatusEditar").value.trim()};if(!o)return console.error("Error: No hay datos originales del nivel"),void mostrarAlerta("Error","No se pudieron comparar los datos originales","error");let n={};if(a.nombre!==o.nombre&&(n.nombre=a.nombre),a.numero!==o.numero&&(n.numero=a.numero),a.estatus!==o.estatus&&(n.estatus=a.estatus),0===Object.keys(n).length)return void mostrarAlerta2("No hay cambios por enviar","error");const r=3===Object.keys(n).length?"PUT":"PATCH",i="PUT"===r?a:n;try{const t=await fetch("/api/niveles/"+e,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const e=await t.json();throw new Error(e.mensaje||"Error desconocido al actualizar")}const a=await t.json();mostrarAlerta(a.titulo,a.mensaje,a.tipo),initDataTable()}catch(t){console.error("Error al actualizar nivel:",t),mostrarAlerta("Error",t.message,"error")}}));document.querySelector(".btnSubirNivel").addEventListener("click",(async function(t){t.preventDefault();const e={nombre:document.getElementById("nombre").value.trim(),numero:document.getElementById("numero").value.trim(),estatus:document.getElementById("estatus").value.trim()};if(""!==e.nombre&&""!==e.numero)try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a=await fetch("/api/niveles",{method:"POST",body:t}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),initDataTable(),document.getElementById("nombre").value="",document.getElementById("numero").value="",document.getElementById("estatus").value=""}catch(t){console.error("Error en la solicitud:",t)}else mostrarAlerta2("Todos los campos son necesarios","error")}))}if("/registro"===window.location.pathname){const t=document.getElementById("crear-cuenta");t&&t.addEventListener("click",(async function(t){t.preventDefault();const e={nombre:document.getElementById("nombre").value.trim(),apellidos:document.getElementById("apellidos").value.trim(),email:document.getElementById("email").value.trim(),password:document.getElementById("password").value.trim(),password2:document.getElementById("password2").value.trim(),telefono:document.getElementById("telefono").value.trim(),direccion:document.getElementById("direccion").value.trim()};if(""!==e.email&&""!==e.nombre&&""!==e.direccion&&""!==e.password&&""!==e.password2&&""!==e.telefono)if(e.password===e.password2){delete e.password2;try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a="http://localhost:3000/registro",n=await fetch(a,{method:"POST",body:t}),o=await n.json();mostrarAlerta(o.titulo,o.mensaje,o.tipo)}catch(t){console.log("Error en la solicitud:",t)}}else mostrarAlerta2("Las contraseñas no coinciden","error");else mostrarAlerta2("Todos los campos son necesarios","error")}))}if("/admin/usuarios"===window.location.pathname){let t,e=!1;const a={1:"Administrador",2:"General",3:"Limpieza"},n={0:"Inactivo",1:"Activo"},o={destroy:!0,pageLength:5,language:{url:"https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json"},dom:'<"row mb-2"<"d-flex justify-content-start col-sm-6"f>><"row"<"col-sm-12"tr>><"row d-flex justify-content-between"<"col d-flex justify-content-start"l><"col d-flex justify-content-center"i><"col d-flex justify-content-end"p>>',columnDefs:[{orderable:!1,targets:[3,8]},{visible:!1,targets:[7]}]};async function initDataTable(){e&&t.destroy();const a=await listarUsers();a.length>0&&llenarTabla(a),t=$("#datatable_users").DataTable(o),e=!0}async function listarUsers(){try{const t=await fetch("/api/usuarios");return await t.json()}catch(t){return console.error("Error al obtener usuarios:",t),[]}}function llenarTabla(t){const e=document.getElementById("tableBody_users");e.innerHTML="",t.forEach((t,o)=>{const r=a[t.rol_id]||"Desconocido",i=n[t.estatus]||"Desconocido",l=`\n                <tr>\n                    <td>${o+1}</td>\n                    <td><img src="/build/img/${t.img}.png" alt="Descripción de la imagen" width="65"></td>\n                    <td>${t.nombre}</td>\n                    <td>${t.apellido}</td>\n                    <td>${t.direccion}</td>\n                    <td>${t.email}</td>\n                    <td>${t.telefono}</td>\n                    <td>******</td> \x3c!-- Ocultamos la contraseña en opciones de la tabla --\x3e\n                    <td>${r}</td>\n                    <td class="text-center">${i}</td>\n                    <td>\n                        \x3c!-- Botón de editar que abre el modal --\x3e\n                        <button \n                            class="btn btn-sm btn-primary btnEditarUsuario" \n                            data-id="${t.id}" \n                            data-toggle="modal" \n                            data-target="#usuarioEditarModal">\n                            <i class="fa-solid fa-pen"></i>\n                        </button>\n                        \x3c!-- Botón de eliminar --\x3e\n                        <button class="btn btn-sm btn-danger btn-eliminarUsuario" data-id="${t.id}">\n                            <i class="fa-solid fa-trash"></i>\n                        </button>\n                    </td>\n                </tr>\n            `;e.innerHTML+=l})}initDataTable(),document.getElementById("tableBody_users").addEventListener("click",(async function(t){if(t.target.closest(".btn-eliminarUsuario")){const e=t.target.closest(".btn-eliminarUsuario").getAttribute("data-id");if((await Swal.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{const t="/api/usuarios/"+e,a=await fetch(t,{method:"DELETE"}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),"success"===n.tipo&&await initDataTable()}catch(t){console.error(t)}}})),document.addEventListener("click",(async function(t){if(t.target.closest(".btnEditarUsuario")){const e=t.target.closest(".btnEditarUsuario").dataset.id;try{const t=await fetch("/api/usuarios/"+e);if(!t.ok)throw new Error("Error al obtener usuario: "+t.statusText);const a=await t.json();document.getElementById("nombreEditar").value=a.nombre,document.getElementById("apellidoEditar").value=a.apellido,document.getElementById("direccionEditar").value=a.direccion,document.getElementById("emailEditar").value=a.email,document.getElementById("telefonoEditar").value=a.telefono,document.getElementById("rol_idEditar").value=a.rol_id,document.getElementById("estatusEditar").value=a.estatus;document.getElementById("imgEditar").src=a.img?`/build/img/${a.img}.png`:"/build/img/default.png",document.querySelector(".btnActualizarUsuario").dataset.id=e,$("#usuarioEditarModal").modal("show")}catch(t){console.error("Error al obtener los datos del usuario:",t)}}})),document.getElementById("formEditarUsuario").addEventListener("submit",(async function(t){t.preventDefault();const e=document.querySelector(".btnActualizarUsuario").dataset.id,a={nombre:document.getElementById("nombreEditar").value.trim(),apellido:document.getElementById("apellidoEditar").value.trim(),direccion:document.getElementById("direccionEditar").value.trim(),email:document.getElementById("emailEditar").value.trim(),telefono:document.getElementById("telefonoEditar").value.trim(),password:document.getElementById("passwordEditar").value.trim(),password2:document.getElementById("password2Editar").value.trim(),rol_id:document.getElementById("rol_idEditar").value.trim(),estatus:document.getElementById("estatusEditar").value.trim(),img:document.getElementById("logoEditar").files[0]};if(a.password===a.password2)if(a.telefono.length>10)mostrarAlerta("Error","Telefono no valido","error");else{delete a.password2;try{const t=new FormData;Object.entries(a).forEach(([e,a])=>t.append(e,a));const n=await fetch("/api/usuarios/"+e,{method:"POST",body:t}),o=await n.json();mostrarAlerta(o.titulo,o.mensaje,o.tipo),initDataTable()}catch(t){console.error("Error al actualizar usuario:",t)}}else mostrarAlerta("Error","Las contraseñas no coinciden.","error")}));document.querySelector(".btnSubirUsuario").addEventListener("click",(async function(t){t.preventDefault();const e={nombre:document.getElementById("nombre").value.trim(),apellido:document.getElementById("apellido").value.trim(),direccion:document.getElementById("direccion").value.trim(),email:document.getElementById("email").value.trim(),telefono:document.getElementById("telefono").value.trim(),password:document.getElementById("password").value.trim(),password2:document.getElementById("password2").value.trim(),rol_id:document.getElementById("rol_id").value.trim(),estatus:document.getElementById("estatus").value.trim(),img:document.getElementById("logo").files[0]};if(""===e.email||""===e.nombre||""===e.direccion||""===e.password||""===e.password2||""===e.telefono)return void mostrarAlerta2("Todos los campos son necesarios","error");if(e.password!==e.password2)return void mostrarAlerta2("Las contraseñas no coinciden.","error");if(e.telefono.length>10)return void mostrarAlerta2("Telefono no valido","error");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)){delete e.password2;try{const t=new FormData;Object.entries(e).forEach(([e,a])=>t.append(e,a));const a=await fetch("/api/usuarios",{method:"POST",body:t}),n=await a.json();mostrarAlerta(n.titulo,n.mensaje,n.tipo),initDataTable()}catch(t){console.error("Error en la solicitud:",t)}}else mostrarAlerta2("El correo electrónico no tiene un formato válido.","error")}))}
//# sourceMappingURL=bundle.js.map
